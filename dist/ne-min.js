"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),o=window.setTimeout(function(){t(r+i)},i);return e=r+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),window.ne={},window.ne.tools={},ne.tools.gl=function(){var e={};return e.textureFromCanvas=function(e,t){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),n},e.bindTexture=function(e,t){e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)},e.bindBuffer=function(e,t,n){e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)},e.draw=function(e){e.drawArrays(e.TRIANGLES,0,6)},e.checkShader=function(e,t){var n=e.getShaderParameter(t,e.COMPILE_STATUS);if(!n){var r=e.getShaderInfoLog(t),i="Could not compile shader:"+r+".\nSource was:\n"+source;throw e.deleteShader(t),i}},e.makeShader=function(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),this.checkShader(e,r),r},e.checkProgram=function(e,t){var n=e.getProgramParameter(t,e.LINK_STATUS);if(!n)throw"program failed to link:"+e.getProgramInfoLog(t)},e.makeProgram=function(e,t,n){var r=e.createProgram();return e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),this.checkProgram(e,r),r},e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Loader=function(){var e={audio:{},pixmaps:{},json:{},fonts:{}};return function(){function t(){_classCallCheck(this,t),this._whenDone=[]}return _createClass(t,[{key:"loadPixmaps",value:function(t,n){return"undefined"==typeof e.pixmaps[t],this}},{key:"loadAudio",value:function(t,n){return"undefined"==typeof e.audio[t],this}},{key:"loadJson",value:function(t,n){return"undefined"==typeof e.json[t],this}},{key:"loadFont",value:function(t,n){return"undefined"==typeof e.fonts[t],this}},{key:"pixmap",value:function(e){}},{key:"audio",value:function(e){}},{key:"json",value:function(e){}},{key:"font",value:function(e){}},{key:"done",value:function(e){return this._whenDone.push(e),this}}],[{key:"clear",value:function(){this.clearPixmaps(),this.clearAudio(),this.clearJson()}},{key:"clearPixmaps",value:function(){}},{key:"clearAudio",value:function(){}},{key:"clearJson",value:function(){}}]),t}()}(),ne.tools.defineEscalarPorperties=function(){function e(e){function t(e,r){for(var i,r=r||[],o=0;o<e.length;o++)i=e.splice(o,1),0===e.length&&n.push(r.concat(i)),t(e.slice(),r.concat(i)),e.splice(o,0,i[0]);return n}var n=[];return t(e)}function t(e){var t=e.length;return{get:function(){var t=this,n=e.map(function(e){return t[e]});return new(Function.prototype.bind.apply(ne.Vec4,[null].concat(_toConsumableArray(n))))},set:function(n){for(var r=0;t>r;++r){var i=e[r];this[i]=n[r]}},configurable:!0}}function n(e,n,r){n.forEach(function(n){var i=n.slice(0,r+1),o=i.join("");"undefined"==typeof e[o]&&(e[o]=t(i))})}function r(t){for(var r={},i=e(t),o=1;o<=t.length;++o)n(r,i,o);return r}return function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];Object.defineProperties(e,r(n))}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Vec2=function(){var e=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];_classCallCheck(this,e),this.x=t,this.y=n}return _createClass(e,[{key:Symbol.iterator,value:function(){for(var e=-1,t=[],n=this.length,r=0;n>r;++r)t.push(this[r]);return{next:function(){return{value:t[++e],done:e>=n}}}}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"length",get:function(){return 2}},{key:"0",get:function(){return this.x},set:function(e){this.x=e}},{key:"1",get:function(){return this.y},set:function(e){this.y=e}},{key:"2",get:function(){return this.z}},{key:"r",get:function(){return this.x},set:function(e){this.x=e}},{key:"s",get:function(){return this.y},set:function(e){this.y=e}},{key:"u",get:function(){return this.x},set:function(e){this.x=e}},{key:"v",get:function(){return this.y},set:function(e){this.y=e}},{key:"g",get:function(){return this.y},set:function(e){this.y=e}}]),e}();return ne.tools.defineEscalarPorperties(e.prototype,"x","y"),ne.tools.defineEscalarPorperties(e.prototype,"r","s"),ne.tools.defineEscalarPorperties(e.prototype,"r","g"),ne.tools.defineEscalarPorperties(e.prototype,"u","v"),e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0===a?void 0:a.call(r)};ne.Vec3=function(){var e=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return i.z=r,i}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z)}},{key:"set",value:function(e,n){var r=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];"undefined"!=typeof r&&(this.z=r),_get(Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n)}},{key:"length",get:function(){return 3}},{key:"2",get:function(){return this.z},set:function(e){this.z=e}},{key:"b",get:function(){return this.z},set:function(e){this.z=e}}]),t}(ne.Vec2);return ne.tools.defineEscalarPorperties(e.prototype,"x","y","z"),ne.tools.defineEscalarPorperties(e.prototype,"r","g","b"),e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0===a?void 0:a.call(r)};ne.Vec4=function(){var e=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];_classCallCheck(this,t);var o=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n,r));return o.w=i,o}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,n,r){var i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3];"undefined"!=typeof i&&(this.w=i),_get(Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n,r)}},{key:"clone",value:function(){return new t(this.x,this.y,this.z,this.w)}},{key:"length",get:function(){return 4}},{key:"a",get:function(){return this.w},set:function(e){this.w=e}},{key:"3",get:function(){return this.w},set:function(e){this.w=e}}]),t}(ne.Vec3);return ne.tools.defineEscalarPorperties(e.prototype,"x","y","z","w"),ne.tools.defineEscalarPorperties(e.prototype,"r","g","b","a"),e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Point=function(){var e=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return i.z=r,i}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];this.x=e,this.y=t,this.z="undefined"==typeof n?n:this.z}},{key:"clone",value:function(){return new t(this.x,this.y,this.z)}},{key:"length",get:function(){return this.dimensions}},{key:"dimensions",get:function(){return null===z?2:3}},{key:"2",get:function(){return this.z},set:function(e){this.z=e}}]),t}(ne.Vec2);return ne.tools.defineEscalarPorperties(e.prototype,"x","y","z"),e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function n(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:n(o,t,r)}if("value"in i)return i.value;var a=i.get;return void 0===a?void 0:a.call(r)};ne.RectBase=function(){var e=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n,i,r))}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,n,r,i){_get(Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n,i,r)}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"width",get:function(){return this.w},set:function(e){this.w=e}},{key:"height",get:function(){return this.z},set:function(e){this.z=e}},{key:"h",get:function(){return this.z},set:function(e){this.z=e}},{key:"2",get:function(){return this.w},set:function(e){this.w=e}},{key:"3",get:function(){return this.h},set:function(e){this.h=e}}]),t}(ne.Vec4);return ne.tools.defineEscalarPorperties(e.prototype,"x","y","w","h"),e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Rect=function(){var e=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"topLeft",get:function(){var e=this;return{get x(){return e.x},get y(){return e.y}}}},{key:"topRight",get:function(){var e=this;return{get x(){return e.x+e.width},get y(){return e.y}}}},{key:"bottomLeft",get:function(){var e=this;return{get x(){return e.x},get y(){return e.y+e.height}}}},{key:"bottomRight",get:function(){var e=this;return{get x(){return e.x+e.width},get y(){return e.y+e.height}}}}]),t}(ne.RectBase);return e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.EventManager=function(){return function(){function e(){_classCallCheck(this,e),this._events={}}return _createClass(e,[{key:"fire",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this._ensureEventType(e);var n=!0,r=!0,i=!1,o=void 0;try{for(var a,u=this._events[e][Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value,c=s(t);"undefined"!=typeof c&&c===!1&&(n=!1)}}catch(l){i=!0,o=l}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}},{key:"on",value:function(e,t){this._ensureEventType(e),this._events[e].push(t)}},{key:"off",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null===t)return void(this._events[e]=[]);this._ensureEventType(e);var n=this._events[e].indexOf(t);-1!==n&&this._events[e].splice(n,1)}},{key:"_ensureEventType",value:function(e){"undefined"==typeof this._events[e]&&(this._events[e]=[])}}]),e}()}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.SceneManager=function(){return function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e._sceneStack=[null],e._lastScene=null,e}return _inherits(t,e),_createClass(t,[{key:"goto",value:function(e){this.clearSceneStack(),this.call(e)}},{key:"clearSceneStack",value:function(){this._sceneStack=[null]}},{key:"call",value:function(e){this._sceneStack.push(e)}},{key:"back",value:function(){this._sceneStack.pop()}},{key:"update",value:function(e){return this._lastScene!==this.scene?void this.switchScene():void this.updateScene(e)}},{key:"switchScene",value:function(){this.destroyScene(this._lastScene),this._lastScene=this.scene;var e=new ne.Loader;this.prepareLoad(e),this.scene.load(e)}},{key:"destroyScene",value:function(e){}},{key:"prepareLoad",value:function(e){var t=this;e.done(function(){return t.afterLoad(e)})}},{key:"endLoad",value:function(){}},{key:"afterLoad",value:function(e){this.endLoad(),this.scene.start(e)}},{key:"updateScene",value:function(e){this.scene&&this.scene.act(e)}},{key:"scene",get:function(){return this._sceneStack[this._sceneStack.length-1]}}]),t}(ne.EventManager)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Game=function(){return function(e){function t(e,n,r){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return i.initMembers(e,n,r),i.initEventHandlers(),i.processFrame(),i}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(e,t,n){this.createRenderer(t,n),this.appendRenderer(e),this._time=Date.now()}},{key:"initEventHandlers",value:function(){var e=this;window.addEventListener("resize",function(t){return e.fire("resize",t)}),window.addEventListener("unload",function(t){return e.fire("unload",t)}),window.addEventListener("beforeunload",function(t){return e.fire("beforeunload",t)})}},{key:"createRenderer",value:function(e,t){this._renderer=new ne.WebGLRenderer(e,t)}},{key:"appendRenderer",value:function(e){var t=document.getElementById(e);t.appendChild(this._renderer.view)}},{key:"render",value:function(){this.scene&&this._renderer.render(this.scene)}},{key:"processFrame",value:function(){this.update(this.calculateDelta()),this.render(),window.requestAnimationFrame(this.processFrame.bind(this))}},{key:"calculateDelta",value:function(){var e=Date.now(),t=e-this._time;return this._time=e,t}},{key:"destroyScene",value:function(e){e&&this._renderer.destroy(e)}}]),t}(ne.SceneManager)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function r(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:r(o,t,n)}if("value"in i)return i.value;var a=i.get;return void 0===a?void 0:a.call(n)};ne.ColorBase=function(){var e=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?255:arguments[3];return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n,r,i))}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,n,r){var i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3];return"undefined"==typeof i&&(i=this.alpha),_get(Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n,r,i),this}},{key:"clone",value:function(){return new t(this.red,this.green,this.blue,this.alpha)}},{key:"x",get:function(){return this.red},set:function(e){this.red=e}},{key:"y",get:function(){return this.green},set:function(e){this.green=e}},{key:"z",get:function(){return this.blue},set:function(e){this.blue=e}},{key:"w",get:function(){return this.alpha},set:function(e){this.alpha=e}},{key:"red",get:function(){return this._r},set:function(e){this._r=Math.max(0,Math.min(255,e))}},{key:"green",get:function(){return this._g},set:function(e){this._g=Math.max(0,Math.min(255,e))}},{key:"blue",get:function(){return this._b},set:function(e){this._b=Math.max(0,Math.min(255,e))}},{key:"alpha",get:function(){return this._a},set:function(e){this._a=Math.max(0,Math.min(255,e))}},{key:"hue",get:function(){return this.toHsl()[0]},set:function(e){var t=this.toHsla();t[0]=e;var n=Color.fromHsla(t);this.set(n.red,n.green,n.blue,n.alpha)}},{key:"saturation",get:function(){return this.toHsl()[1]},set:function(e){var t=this.toHsla();t[1]=e;var n=Color.fromHsla(t);this.set(n.red,n.green,n.blue,n.alpha)}},{key:"luminance",get:function(){return this.toHsl()[2]},set:function(e){var t=this.toHsla();t[2]=e;var n=Color.fromHsla(t);this.set(n.red,n.green,n.blue,n.alpha)}}]),t}(ne.Vec4);return e}();var _slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){
function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Color=function(){var e=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){return new t(this.red,this.green,this.blue,this.alpha)}},{key:"toCss",value:function(){var e=this.alpha/255;return"rgba("+this.red+", "+this.green+", "+this.blue+", "+e+")"}},{key:"toArgb",value:function(){return this.alpha<<24+this.red<<16+this.green<<8+this.blue}},{key:"toRgba",value:function(){return this.red<<24+this.green<<16+this.blue<<8+this.alpha}},{key:"toRgb",value:function(){return this.red<<16+this.green<<8+this.blue}},{key:"toHsla",value:function(){var e,t,n=this.red/255,r=this.green/255,i=this.blue/255,o=Math.max(n,r,i),a=Math.min(n,r,i),u=(o+a)/2;if(o==a)e=t=0;else{var s=o-a;switch(t=u>.5?s/(2-o-a):s/(o+a),o){case n:e=(r-i)/s+(i>r?6:0);break;case r:e=(i-n)/s+2;break;case i:e=(n-r)/s+4}e/=6}return[e,t,u,this.alpha]}},{key:"toHsl",value:function(){var e,t,n=this.red/255,r=this.green/255,i=this.blue/255,o=Math.max(n,r,i),a=Math.min(n,r,i),u=(o+a)/2;if(o==a)e=t=0;else{var s=o-a;switch(t=u>.5?s/(2-o-a):s/(o+a),o){case n:e=(r-i)/s+(i>r?6:0);break;case r:e=(i-n)/s+2;break;case i:e=(n-r)/s+4}e/=6}return[e,t,u]}},{key:"grayscale",value:function(){var e=.21*this.red+.72*this.green+.07*this.blue;return this.set(e,e,e)}},{key:"average",value:function(){var e=(this.red+this.green+this.blue)/3;return this.set(e,e,e)}},{key:"lightnessAverage",value:function(){var e,t,n=[this.red,this.green,this.blue],r=((e=Math).max.apply(e,n)+(t=Math).min.apply(t,n))/2;return this.set(r,r,r)}},{key:"invert",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],t=e?255-this.alpha:this.alpha;return this.set(255-this.red,255-this.green,255-this.blue,t)}}],[{key:"_hue2rgb",value:function(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+(t-e)*(2/3-n)*6:e}},{key:"_hslToRgb",value:function(e,n,r,i){var o,a,u;if(0==n)o=a=u=r;else{var s=.5>r?r*(1+n):r+n-r*n,c=2*r-s;o=this._hue2rgb(c,s,e+1/3),a=this._hue2rgb(c,s,e),u=this._hue2rgb(c,s,e-1/3)}return new t(Math.round(255*o),Math.round(255*a),Math.round(255*u),i)}},{key:"fromRgba",value:function(e){var n=e>>24&&255,r=e>>16&&255,i=e>>8&&255,o=e>>0&&255;return new t(n,r,i,o)}},{key:"fromRgb",value:function(e){var n=rgba>>16&&255,r=rgba>>8&&255,i=rgba>>0&&255;return new t(n,r,i)}},{key:"fromArgb",value:function(e){var n=rgba>>24&&255,r=rgba>>16&&255,i=rgba>>8&&255,o=rgba>>0&&255;return new t(r,i,o,n)}},{key:"fromHsla",value:function(e){var t=_slicedToArray(e,4),n=t[0],r=t[1],i=t[2],o=t[3];return this._hslToRgb(n,r,i,o)}},{key:"fromHsl",value:function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1],i=t[2];return this._hslToRgb(n,r,i,255)}}]),t}(ne.ColorBase);return e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.ShaderBase=function(){var e=function(){function e(){_classCallCheck(this,e),this.initMembers()}return _createClass(e,[{key:"initMembers",value:function(){this._glProgram=null,this._glVertex=null,this._glFragment=null,this._glAttributes={},this._glUniforms={}}},{key:"vertex",value:function(){return""}},{key:"fragment",value:function(){return""}},{key:"attributes",value:function(){return{}}},{key:"uniforms",value:function(){return{}}},{key:"varying",value:function(){return{}}},{key:"generate",value:function(e){return this._glProgram||(this.generateVertexShader(e),this.generateFragmentShader(e),this.generateProgram(e),this.generateVariables(e)),this._glProgram}},{key:"use",value:function(e){e.useProgram(this._glProgram)}},{key:"generateVariables",value:function(e){this.generateAttributes(e),this.generateUniforms(e)}},{key:"generateAttributes",value:function(e){var t=this,n=this.attributes();Object.keys(n).forEach(function(n){t._glAttributes[n]=e.getAttribLocation(t._glProgram,n)})}},{key:"generateUniforms",value:function(e){var t=this,n=this.uniforms();Object.keys(n).forEach(function(n){t._glUniforms[n]=e.getUniformLocation(t._glProgram,n)})}},{key:"destroy",value:function(e){this.destroyVertexShader(e),this.destroyFragmentShader(e),this.destroyProgram(e)}},{key:"destroyVertexShader",value:function(e){this._glVertex&&(this._glProgram&&(e.detachShader(this._glProgram,this._glVertex),e.destroyShader(this._glVertex)),this._glVertex=null)}},{key:"destroyFragmentShader",value:function(e){this._glFragment&&(this._glProgram&&(e.detachShader(this._glProgram,this._glFragment),e.destroyShader(this._glFragment)),this._glVertex=null)}},{key:"destroyProgram",value:function(e){this._glProgram&&(e.destroyProgram(this._glProgram),this._glProgram=null)}},{key:"generateVertexShader",value:function(e){try{this._glVertex=ne.tools.gl.makeShader(e,e.VERTEX_SHADER,this.vertexSource())}catch(t){throw this.destroy(e),t}}},{key:"generateFragmentShader",value:function(e){try{this._glFragment=ne.tools.gl.makeShader(e,e.FRAGMENT_SHADER,this.fragmentSource())}catch(t){throw this.destroy(e),t}}},{key:"vertexSource",value:function(){return this.vertexHeader()+this.mainFunction(this.vertex())}},{key:"fragmentSource",value:function(){return this.fragmentHeader()+this.mainFunction(this.fragment())}},{key:"generateProgram",value:function(e){try{this._glProgram=ne.tools.gl.makeProgram(e,this._glVertex,this._glFragment)}catch(t){throw this.destroy(e),t}}},{key:"vertexHeader",value:function(){return this.precision()+this.attributeSource()+this.uniformSource()+this.varyingSource()}},{key:"fragmentHeader",value:function(){return this.precision()+this.uniformSource()+this.varyingSource()}},{key:"sourceFromObject",value:function(e,t){var n="";for(var r in t)if(t.hasOwnProperty(r)){var i=this.glType(t[r]);n+=e+" "+i+" "+r+";"}return n}},{key:"updateAttributes",value:function(e){var t=this;Object.keys(this._glAttributes).forEach(function(n){t.updateAttribute(e,n)})}},{key:"updateAttribute",value:function(e,t){var n=this._glAttributes[t];"undefined"!=typeof n&&(e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0))}},{key:"attributeSource",value:function(){return this.sourceFromObject("attribute",this.attributes())}},{key:"uniformSource",value:function(){return this.sourceFromObject("uniform",this.uniforms())}},{key:"varyingSource",value:function(){return this.sourceFromObject("varying",this.varying())}},{key:"precision",value:function(){return"precision mediump float;"}},{key:"mainFunction",value:function(e){return"void main(void) { "+e+" }"}},{key:"glType",value:function(t){return e.TYPES[t]}}]),e}();return e.TYPES={point:"vec2","3d-point":"vec3",color:"vec4",number:"float",array:"vec4",real:"real",rect:"vec4",vec2:"vec2",vec3:"vec3",vec4:"vec4","float":"float","int":"int"},e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function i(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:i(o,t,n)}if("value"in r)return r.value;var a=r.get;return void 0===a?void 0:a.call(n)};ne.Shader=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(){_get(Object.getPrototypeOf(t.prototype),"initMembers",this).call(this),this._values=this._defaultSet(this.uniforms())}},{key:"_defaultSet",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._getDefaultValue(e[r])}),n}},{key:"_getDefaultValue",value:function(e){switch(e){case"point":return new ne.Point(0,0);case"3d-point":return new ne.Point(0,0,0);case"color":return new ne.Color(0,0,0);case"rect":return new ne.Rect;case"number":case"float":case"real":return 0;case"vec2":return new ne.Vec2;case"vec3":return new ne.Vec3;case"vec4":return new ne.Vec4;case"array":return[0,0,0,0];default:return 0}}},{key:"update",value:function(e){this.updateUniforms(e)}},{key:"updateUniforms",value:function(e){var t=this,n=this.uniformValues,r=this.uniforms();Object.keys(n).forEach(function(i){t.updateUniform(e,i,r[i],n[i])})}},{key:"updateUniform",value:function(e,t,n,r){var i=this._glUniforms[t];"undefined"!=typeof i&&this.updateUniformByType(e,i,n,r)}},{key:"updateUniformByType",value:function(e,t,n,r){switch(n){case"float":case"number":case"real":e.uniform1f(t,r);break;case"vec2":e.uniform2f(t,r[0],r[1]);break;case"vec3":e.uniform3f(t,r[0],r[1],r[2]);break;case"vec4":e.uniform4f(t,r[0],r[1],r[2],r[3]);break;case"point":e.uniform2f(t,r.x,r.y);break;case"rect":e.uniform4f(t,r.x,r.y,r.width,r.height);break;case"color":e.uniform4f(t,r.red/255,r.green/255,r.blue/255,r.alpha/255);break;case"array":e["uniform"+r.length+"f"].apply(e,[t].concat(_toConsumableArray(r)))}}},{key:"uniformValues",get:function(){return this._values}}]),t}(ne.ShaderBase)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Texture=function(){return function(){function e(t){_classCallCheck(this,e),this._data=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._pixmap=t,this._glTexture=null,this._buffer=null,this._isDirty=!1}return _createClass(e,[{key:"generate",value:function(e){return this._isDirty&&(this._isDirty=!1,this.destroyTexture()),this.regenerateTexture(e),this.regenerateBuffer(e),this._glTexture}},{key:"update",value:function(){this._isDirty=!0}},{key:"regenerateTexture",value:function(e){this._glTexture||this.generateTexture(e)}},{key:"regenerateBuffer",value:function(e){this._buffer||this.generateBuffer(e)}},{key:"destroy",value:function(e){this.destroyTexture(e),this.destroyBuffer(e)}},{key:"destroyTexture",value:function(e){this._glTexture&&(e.destroyTexture(e),this._glTexture=null)}},{key:"destroyBuffer",value:function(e){this._buffer&&(e.destroyBuffer(this._buffer),this._buffer=null)}},{key:"generateBuffer",value:function(e){this._buffer=e.createBuffer()}},{key:"generateTexture",value:function(e){this._glTexture=this._pixmap.generateTexture(e)}},{key:"bind",value:function(e,t){this.bindBuffer(e,t),this.bindTexture(e)}},{key:"bindBuffer",value:function(e,t){this.refreshData(t),ne.tools.gl.bindBuffer(e,this._buffer,this._data)}},{key:"refreshData",value:function(e){var t=this.clamp(e.x/this._pixmap.width),n=this.clamp(e.y/this._pixmap.height),r=this.clamp((e.x+e.width)/this._pixmap.width),i=this.clamp((e.y+e.height)/this._pixmap.height);this._data[0]=this._data[4]=this._data[6]=t,this._data[1]=this._data[3]=this._data[9]=n,this._data[2]=this._data[8]=this._data[10]=r,this._data[5]=this._data[7]=this._data[11]=i}},{key:"clamp",value:function(e){return Math.max(0,Math.min(1,e))}},{key:"bindTexture",value:function(e){ne.tools.gl.bindTexture(e,this._glTexture)}}]),e}()}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Pixmap=function(){return function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=arguments.length<=1||void 0===arguments[1]?1:arguments[1];_classCallCheck(this,e),this._canvas=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=n,this._context=this._canvas.getContext("2d")}return _createClass(e,[{key:"_bltImage",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],i=arguments.length<=4||void 0===arguments[4]?void 0:arguments[4],o=arguments.length<=5||void 0===arguments[5]?0:arguments[5],a=arguments.length<=6||void 0===arguments[6]?0:arguments[6],u=arguments.length<=7||void 0===arguments[7]?void 0:arguments[7],s=arguments.length<=8||void 0===arguments[8]?void 0:arguments[8];return"undefined"==typeof r&&(r=e.width),"undefined"==typeof i&&(i=e.height),"undefined"==typeof u&&(u=r),"undefined"==typeof s&&(s=i),this._context.drawImage(e,t,n,r,i,o,a,u,s),this}},{key:"blt",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],i=arguments.length<=4||void 0===arguments[4]?void 0:arguments[4],o=arguments.length<=5||void 0===arguments[5]?0:arguments[5],a=arguments.length<=6||void 0===arguments[6]?0:arguments[6],u=arguments.length<=7||void 0===arguments[7]?void 0:arguments[7],s=arguments.length<=8||void 0===arguments[8]?void 0:arguments[8];return this._bltImage(e._canvas,t,n,r,i,o,a,u,s),this}},{key:"drawLine",value:function(e,t,n){}},{key:"generateTexture",value:function(e){return ne.tools.gl.textureFromCanvas(e,this._canvas)}},{key:"width",get:function(){return this._canvas.width}},{key:"height",get:function(){return this._canvas.height}}],[{key:"fromImage",value:function(t){var n=new e(t.width,t.height);return n._bltImage(t,0,0,t.width,t.height),n}}]),e}()}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Renderer=function(){return function(){function e(t,n){_classCallCheck(this,e),this.initMembers(t,n)}return _createClass(e,[{key:"initMembers",value:function(e,t){this.createCanvas(e,t),this.createContext()}},{key:"createCanvas",value:function(e,t){this._canvas=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=t}},{key:"createContext",value:function(){}},{key:"render",value:function(e){}},{key:"destroy",value:function(e){}},{key:"resize",value:function(e,t){this._canvas.width=e,this._canvas.height=t}},{key:"view",get:function(){return this._canvas}},{key:"width",get:function(){return this._canvas.width}},{key:"height",get:function(){return this._canvas.height}}]),e}()}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.WebGLRenderer=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"createContext",value:function(){if(this._gl=this.view.getContext("webgl"),this._gl||(this._gl=this.view.getContext("exerimental-webgl")),!this._gl)throw"Your browser doesn't support webgl."}},{key:"render",value:function(e){e.render(this._gl)}},{key:"destroy",value:function(e){e.destroy(this._gl)}}]),t}(ne.Renderer)}(),ne.Canvas2DRenderer=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),t}(ne.Renderer)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.Drawable=function(){return function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e.initMembers(),e}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(){this._parent=null,this.z=0}},{key:"render",value:function(e){}},{key:"destroy",value:function(e){}},{key:"render2D",value:function(e){}},{key:"parent",get:function(){return this._parent}},{key:"z",get:function(){return this._z},set:function(e){this._z=e;var t=this.parent;t&&t.zUpdate()}}]),t}(ne.EventManager)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:o(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0===a?void 0:a.call(n)};ne.Actor=function(){var e=function(e){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,Object.getPrototypeOf(n).apply(this,arguments))}return _inherits(n,e),_createClass(n,[{key:"initMembers",value:function(){_get(Object.getPrototypeOf(n.prototype),"initMembers",this).call(this),this._twigs=[]}},{key:"act",value:function(e){}},{key:"twig",value:function(e,n){var r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return r||(r=this.defaultTwigMode()),0>=n?void this._setProperties(e):void this._twigs.push(new t(this,e,n,r))}},{key:"defaultTwigMode",value:function(){return t.LINEAR}},{key:"act",value:function(e){this.updateTwigs(e)}},{key:"updateTwigs",value:function(e){var t=this._twigs.filter(function(t){return t.update(e)});this.removeTwigs(t)}},{key:"removeTwigs",value:function(e){var t=this;e.forEach(function(e){var n=t._twigs.indexOf(e);t._setProperties(e.properties),t._twigs.splice(n,1)})}},{key:"_setProperties",value:function(e){var t=this;Object.keys(e).forEach(function(n){t[n]=e[n]})}}]),n}(ne.Drawable),t=function(){function e(t,n,r,i){_classCallCheck(this,e),this.initMembers(t,n,r,i)}return _createClass(e,[{key:"initMembers",value:function(e,t,n,r){this._properties=t,this._time=n,this._totalTime=n,this._type=r,this._subject=e,this._initialValues=this.createInitialValues(e,t)}},{key:"createInitialValues",value:function(e,t){var n={},r=!0,i=!1,o=void 0;try{for(var a,u=Object.keys(t)[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;n[s]=e[s]}}catch(c){i=!0,o=c}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}},{key:"update",value:function(e){return this._time=this._time-e,this._time>0?(this.updateFunctions(),!1):!0}},{key:"updateFunctions",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=Object.keys(this._properties)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=this._initialValues[o],u=this._properties[o],s=this._subject[o],c=this._type(a,u,s,this._totalTime,this._time);this._subject[o]=c}}catch(l){t=!0,n=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw n}}}},{key:"properties",get:function(){return this._properties}}]),e}();return e.Twig=t,t.LINEAR=function(e,t,n,r,i){return(n*(i-1)+t)/i},e}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function a(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:a(i,t,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)};ne.Container=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(){_get(Object.getPrototypeOf(t.prototype),"initMembers",this).call(this),this._children=[],this._zRefresh=!1}},{key:"act",value:function(e){_get(Object.getPrototypeOf(t.prototype),"act",this).call(this,e),this._refreshZ(),this._makeChildrenAct(e)}},{key:"render",value:function(e){this._renderChildren(e)}},{key:"destroy",value:function(e){_get(Object.getPrototypeOf(t.prototype),"destroy",this).call(this,e),this.destroyChildren(e)}},{key:"zUpdate",value:function(){this._zRefresh=!0}},{key:"_refreshZ",value:function(){this._zRefresh&&(this.children.sort(function(e,t){return e.z-t.z}),this._zRefresh=!1)}},{key:"destroyChildren",value:function(e){this.children.forEach(function(t){return t.destroy(e)})}},{key:"_makeChildrenAct",value:function(e){this.children.forEach(function(t){return t.act(e)})}},{key:"_renderChildren",value:function(e){this.children.forEach(function(t){return t.render(e)})}},{key:"add",value:function(e){this.contains(e)||(this.children.push(e),this.zUpdate())}},{key:"remove",value:function(e){var t=this.indexOf(e);-1!==t&&this.children.splice(t,1)}},{key:"indexOf",value:function(e){return this.children.indexOf(e)}},{key:"clear",value:function(){this.children=[]}},{key:"swap",value:function(e,t){var n=this.indexOf(e),r=this.indexOf(t);if(-1!==n&&-1!==r){var i=e.z;e.z=t.z,t.z=i}}},{key:"contains",value:function(e){return-1!==this.indexOf(e)}},{key:"children",get:function(){return this._children}}]),t}(ne.Actor)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function u(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:u(i,t,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)};ne.Sprite=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(){_get(Object.getPrototypeOf(t.prototype),"initMembers",this).call(this),this.position=new ne.Point,this.scale=new ne.Point(1,1),this.offset=new ne.Point,this.shader=new ne.SpriteShader}},{key:"move",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?null:arguments[3];this.twig({x:e,y:t},n,r)}},{key:"x",get:function(){return this.position.x},set:function(e){this.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){this.position.y=e}}]),t}(ne.Actor)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function s(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:s(i,t,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)};ne.Scene=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"initMembers",value:function(){_get(Object.getPrototypeOf(t.prototype),"initMembers",this).call(this),this.shader=new ne.SceneShader,this._glBuffer=null,this._glData=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}},{key:"load",value:function(e){}},{key:"start",value:function(e){}},{key:"render",value:function(e){this.shader.generate(e),this.shader.use(e),this.useBuffer(e),this.updateShader(e),ne.tools.gl.draw(e)}},{key:"destroy",value:function(e){_get(Object.getPrototypeOf(t.prototype),"destroy",this).call(this,e),this.destroyBuffer(e),this.shader.destroy(e)}},{key:"useBuffer",value:function(e){this.generateBuffer(e),ne.tools.gl.bindBuffer(e,this._glBuffer,this._glData)}},{key:"updateShader",value:function(e){this.shader.updateAttribute(e,"a_position"),this.shader.update(e)}},{key:"destroyBuffer",value:function(e){this._glBuffer&&e.deleteBuffer(this._glBuffer)}},{key:"generateBuffer",value:function(e){this._glBuffer||(this._glBuffer=e.createBuffer())}},{key:"bgColor",get:function(){return this.shader.uniformValues.u_bgColor}}]),t}(ne.Container)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.SpriteShader=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"vertex",value:function(){return"gl_Position = vec4(a_position, 0, 1);"}},{key:"fragment",value:function(){return"gl_FragColor = vec4(0, 1, 0, 1);"}},{key:"attributes",value:function(){return{a_position:"vec2"}}},{key:"uniforms",value:function(){return{}}},{key:"varying",value:function(){return{}}}]),t}(ne.Shader)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();ne.SceneShader=function(){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"vertex",value:function(){return"gl_Position = vec4(a_position, 0, 1);"}},{key:"fragment",value:function(){return"gl_FragColor = u_bgColor;"}},{key:"attributes",value:function(){return{a_position:"vec2"}}},{key:"uniforms",value:function(){return{u_bgColor:"color"}}}]),t}(ne.Shader)}();